<!--
Ukulele Tuesday ‚Äì Break Timer + Donate (projector-ready)
Single-file HTML. Open in a browser (F11 for fullscreen).

URL params (optional):
  minutes   ‚Äì total minutes for the countdown (default: 10)
  title     ‚Äì headline (default: "Ukulele Tuesday will resume in")
  subtitle  ‚Äì small line above timer (default: "We‚Äôre on a short break")
  ctaText   ‚Äì button text (default: "Donate now")
  ctaUrl    ‚Äì donation link (default: https://buymeacoffee.com/UkuleleTuesday)
  note      ‚Äì line under the button (e.g., "Every ‚Ç¨5 prints a songbook")

  qr        ‚Äì "1" to show QR (default: 1)
  logo      ‚Äì URL/path to a logo image (optional). Place a local file like logo.svg next to this HTML and pass ?logo=logo.svg

If you want this totally offline, the QR <img> uses a public QR service.
Ping me if you want me to swap in an embedded generator.
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="theme-color" content="#0b1221" />
<title>Ukulele Tuesday ‚Äì Break Timer</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: #0f8b81;          /* PRIMARY background as requested */
      --fg: #ffffff;          /* foreground on teal */
      --muted: rgba(255,255,255,.85);
      --accent:#ffffff;       /* accents default to white for contrast */
      --accent2:#e8fff9;      /* soft highlight */
      --card: rgba(0,0,0,.12);/* subtle glass card on teal */
      --shadow: 0 16px 46px rgba(0,0,0,.28);
    }
    html,body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji";
      color:var(--fg); background: var(--bg);
      display:flex; align-items:center; justify-content:center; min-height:100vh;
    }
    .wrap{ width:min(980px, 94vw); padding:clamp(16px,3.5vw,40px) max(16px, env(safe-area-inset-right)) max(16px, env(safe-area-inset-bottom)) max(16px, env(safe-area-inset-left)); margin-inline:auto; }
    .card{ background:var(--card); backdrop-filter: blur(8px); border-radius:24px; padding:clamp(16px,2.5vw,32px); box-shadow:var(--shadow); }

    /* iPad Portrait optimization */
    @media (max-width: 900px) and (orientation: portrait), (max-height: 1200px) and (orientation: portrait){ 
      .wrap{ width: min(750px, 92vw); padding: clamp(12px, 2.5vw, 24px); }
    }

    header{ text-align: center; margin-bottom:10px; }
    header img{ height:120px; width:auto; filter: drop-shadow(0 8px 16px rgba(0,0,0,.25)); display: block; margin: 0 auto 8px auto; }
    .brand{ text-align: center; display: flex; flex-direction: column; align-items: center; }
    .brand h1{ font-family: 'Bebas Neue', ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans"; font-size: clamp(28px,6.5vmin,56px); line-height:1.1; margin:0; letter-spacing:.2px; text-align: center; }
    .brand .sub{ color:var(--muted); font-weight:500; font-size: clamp(14px,1.6vw,18px); }

    .headline{ font-size: clamp(18px,3.6vmin,28px); color:var(--muted); margin: 12px 0 6px; text-align:center; }
    .timer{ font-variant-numeric: tabular-nums; letter-spacing:.02em; font-weight:900; text-shadow:0 10px 30px rgba(0,0,0,.35);
            font-size: clamp(80px, 18vmin, 240px); line-height: .95; text-align:center; }
    .resume{ font-size: clamp(16px,3.8vmin,24px); color: var(--muted); margin-top:8px; text-align:center; }

    .cta-area{ display:flex; flex-direction:column; align-items:center; gap:18px; text-align:center; padding-top: clamp(16px,3.2vw,28px); margin-top: clamp(16px,3.2vw,28px); border-top: 1px solid rgba(255,255,255,.1); }
    .cta-display{ font-weight:900; font-size: clamp(26px,6vmin,40px); color: var(--fg); text-align: center; 
              margin-bottom: 8px; }

    .cta-small{ color:var(--muted); font-size: clamp(13px,3vmin,16px); }
    .qr{ display:grid; place-items:center; width:min(50vw, 350px); aspect-ratio:1/1; background:#fff; border-radius:20px; padding:18px; box-shadow: var(--shadow); margin: 0 auto; }
    .qr img{ width:100%; height:100%; object-fit:contain; border-radius:12px; }

    .controls{ display:flex; flex-wrap:wrap; gap:8px; margin-top:14px; justify-content:center; }
    .controls.hidden{ display:none; }
    .chip{ background: rgba(255,255,255,.08); border: 1px solid rgba(255,255,255,.12); padding:8px 12px; border-radius:999px; color:var(--fg);
           font-weight:700; cursor:pointer; user-select:none; }

    .progress{ height:10px; background: rgba(255,255,255,.22); border-radius:999px; overflow:hidden; margin: 18px auto 0; width:min(900px, 90%); }
    .bar{ height:100%; width:0%; background: linear-gradient(90deg, rgba(255,255,255,.95), rgba(255,255,255,.65)); transition: width .2s linear; }

    .back{ font-size: clamp(24px,6vw,64px); color: var(--accent2); font-weight:900; letter-spacing:.4px; text-shadow:0 8px 24px rgba(0,0,0,.4); }
    .blink{ animation: blink 1.8s steps(2,start) infinite; }
    @keyframes blink { 50% { opacity: .35; } }

    footer{ margin-top: 14px; color:var(--muted); font-size: 14px; display:flex; justify-content:space-between; gap:12px; align-items:center; flex-wrap:wrap; }
    /* iPad touch/overlay styles */
    .hint{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.55);z-index:50}
    .hint-inner{background:var(--card);padding:24px 28px;border-radius:20px;box-shadow:var(--shadow);text-align:center;max-width:90vw}
    .h-title{font-weight:900;font-size:clamp(16px,2.2vw,22px);margin-bottom:6px}
    .h-rows{color:var(--muted);font-size:clamp(14px,1.8vw,18px);display:grid;gap:4px;margin-bottom:10px}
    .h-dismiss{font-size:13px;color:var(--muted)}
    .toast{position:fixed;left:50%;bottom:6vh;transform:translateX(-50%);background:var(--card);padding:10px 14px;border-radius:999px;box-shadow:var(--shadow);font-weight:800;z-index:60;display:none}
  </style>
</head>
<body>
  <div class="wrap">
    <div>
      <section class="card" aria-live="polite">
        <header>
          <div class="brand">
            <img id="logo" alt="Ukulele Tuesday logo" style="display:none; margin-bottom: 8px;" />
            <div class="sub" id="subtitle">We‚Äôre on a short break</div>
            <h1 id="title">Ukulele Tuesday will resume in</h1>
          </div>
        </header>

        <div class="headline" id="headline">Tip: every ‚Ç¨5 prints a songbook</div>
        <div class="timer" id="timer" role="timer" aria-live="polite">10:00</div>
        <div class="resume" id="resumeText"></div>

        <div class="progress"><div class="bar" id="bar"></div></div>

        <div class="controls hidden" id="controls">
          <div class="chip" id="pauseBtn">Pause</div>
          <div class="chip" id="plus1">+1 min</div>
          <div class="chip" id="minus1">‚àí1 min</div>
          <div class="chip" id="extend30">+30 sec</div>
          <div class="chip" id="resetBtn">Reset</div>
          <div class="chip" id="wakeLockBtn">Awake: OFF</div>
        </div>
        
        <div class="cta-area">
          <div id="cta" class="cta-display">Donate now</div>
          <div class="cta-small" id="ctaNote">Scan the QR code with your phone to donate</div>
          <div id="qrWrap" class="qr" style="display:none">
            <img id="qr" alt="Scan to donate" />
          </div>
        </div>
      </section>
    </div>

    <footer>
    </footer>
  </div>

    <div id="touchHint" class="hint" style="display:none">
      <div class="hint-inner">
        <div class="h-title">Touch controls</div>
        <div class="h-rows">
          <div>Tap anywhere: <b>Pause/Resume</b></div>
        </div>
        <div class="h-dismiss">Tap to dismiss</div>
      </div>
    </div>
    <div id="toast" class="toast"></div>

  <script>
    const qs = new URLSearchParams(location.search);
    const defaults = {
      minutes: 10,
      title: 'will resume in',
      subtitle: '',
      headline: '',
      ctaText: 'Help Keep the Music Alive! üéµ',
      ctaUrl: 'https://buymeacoffee.com/UkuleleTuesday?utm_source=projector&utm_medium=screen&utm_campaign=break-appeal',
      note: 'Scan with your phone to support us ‚¨áÔ∏è',
      qr: '1',
      logo: 'ut-logo-wordmark-white.png',
      autostart: 'true'
    };

    const cfg = {
      minutes: parseFloat(qs.get('minutes') || qs.get('m') || defaults.minutes) || defaults.minutes,
      title: qs.get('title') || defaults.title,
      subtitle: qs.get('subtitle') || defaults.subtitle,
      headline: qs.get('headline') || defaults.headline,
      ctaText: qs.get('ctaText') || defaults.ctaText,
      ctaUrl: qs.get('ctaUrl') || defaults.ctaUrl,
      note: qs.get('note') || defaults.note,
      qr: (qs.get('qr') || defaults.qr),
      logo: qs.get('logo') || defaults.logo,
      autostart: (qs.get('autostart') || defaults.autostart)
    };



    // Fill static text
    document.getElementById('title').textContent = cfg.title;
    const subtitleEl = document.getElementById('subtitle');
    if (cfg.subtitle) {
      subtitleEl.textContent = cfg.subtitle;
      subtitleEl.style.display = 'block';
    } else {
      subtitleEl.style.display = 'none';
    }
    const headlineEl = document.getElementById('headline');
    if (cfg.headline) {
      headlineEl.textContent = cfg.headline;
      headlineEl.style.display = 'block';
    } else {
      headlineEl.style.display = 'none';
    }
    document.getElementById('cta').textContent = cfg.ctaText;
    document.getElementById('ctaNote').textContent = cfg.note;

    // Logo (optional)
    if (cfg.logo){
      const l = document.getElementById('logo'); l.src = cfg.logo; l.style.display = 'block';
    }

    // QR (optional)
    const qrWrap = document.getElementById('qrWrap');
    if (cfg.qr !== '0'){
      const qrImg = document.getElementById('qr');
      const encoded = encodeURIComponent(cfg.ctaUrl);
      // Public QR service (online). For an offline projector variant, swap this for an embedded generator.
      qrImg.src = `https://api.qrserver.com/v1/create-qr-code/?size=480x480&data=${encoded}`;
      qrWrap.style.display = 'grid';
    }

    // Timer logic
    let totalMs = Math.max(0, Math.round(cfg.minutes * 60 * 1000));
    const startTotalMs = totalMs;
    let remainingMs = totalMs;
    let paused = cfg.autostart === 'false';
    let lastTs = performance.now();

    const timerEl = document.getElementById('timer');
    const resumeEl = document.getElementById('resumeText');
    const bar = document.getElementById('bar');

    const fmt = (ms)=>{
      const s = Math.max(0, Math.floor(ms/1000));
      const mm = String(Math.floor(s/60)).padStart(2,'0');
      const ss = String(s%60).padStart(2,'0');
      return `${mm}:${ss}`;
    };

    const updateEcho = ()=>{
      const backAt = new Date(Date.now() + remainingMs);
      const opts = { hour: '2-digit', minute: '2-digit' };
      resumeEl.textContent = remainingMs>0 ? `Back at ${backAt.toLocaleTimeString([], opts)}` : '';
    }

    const render = ()=>{
      timerEl.textContent = fmt(remainingMs);
      const done = 1 - (remainingMs / Math.max(1,startTotalMs));
      bar.style.width = `${(done*100).toFixed(2)}%`;
      updateEcho();
      if (remainingMs <= 0){
        timerEl.classList.add('back','blink');
        timerEl.textContent = 'WE\u2019RE BACK!';
        resumeEl.textContent = '';
        document.getElementById('headline').textContent = 'Grab your uke! Let\u2019s play.';
      }
    };

    const tick = (ts)=>{
      if (!paused && remainingMs>0){
        const dt = ts - lastTs;
        remainingMs = Math.max(0, remainingMs - dt);
        render();
      }
      lastTs = ts;
      requestAnimationFrame(tick);
    };

    // Controls
    function addMs(ms){ remainingMs = Math.max(0, remainingMs + ms); totalMs = Math.max(0, totalMs + ms); render(); }
    
    // Controls visibility management
    const controlsEl = document.getElementById('controls');
    let controlsVisible = false;
    
    function showControls() {
      if (!controlsVisible) {
        controlsEl.classList.remove('hidden');
        controlsVisible = true;
      }
    }
    
    function hideControls() {
      if (controlsVisible) {
        controlsEl.classList.add('hidden');
        controlsVisible = false;
      }
    }
    
    function setPaused(p){ 
      paused = p; 
      document.getElementById('pauseBtn').textContent = p ? 'Resume' : 'Pause';
      if (p) {
        showControls(); // Show controls when paused
      } else {
        hideControls(); // Hide controls when resumed
      }
    }

    document.getElementById('pauseBtn').addEventListener('click', ()=> setPaused(!paused));
    document.getElementById('plus1').addEventListener('click', ()=> addMs(60_000));
    document.getElementById('minus1').addEventListener('click', ()=> addMs(-60_000));
    document.getElementById('extend30').addEventListener('click', ()=> addMs(30_000));
    document.getElementById('resetBtn').addEventListener('click', ()=>{ remainingMs = totalMs = startTotalMs; timerEl.classList.remove('back','blink'); render(); });



    // --- iPad/mobile enhancements ---
    const isTouch = 'ontouchstart' in window || navigator.maxTouchPoints>0;

    // Toast helper
    const toastEl = document.getElementById('toast');
    function showToast(txt){ if(!toastEl) return; toastEl.textContent = txt; toastEl.style.display='block'; clearTimeout(showToast.t); showToast.t=setTimeout(()=>toastEl.style.display='none', 900); }

    // Wake Lock toggle
    let wakeLock = null, wakeOn = false; const wakeBtn = document.getElementById('wakeLockBtn');
    async function setWake(on){
      if (!('wakeLock' in navigator)) { showToast('No Wake Lock'); return; }
      try{
        if (on && !wakeLock){
          wakeLock = await navigator.wakeLock.request('screen');
          wakeBtn.textContent = 'Awake: ON';
          wakeLock.addEventListener('release', ()=>{ wakeBtn.textContent='Awake: OFF'; wakeLock=null; });
        } else if (!on && wakeLock){
          await wakeLock.release(); wakeBtn.textContent='Awake: OFF'; wakeLock=null;
        }
      }catch(e){ showToast('Wake Lock error'); }
    }
    wakeBtn?.addEventListener('click', ()=>{ wakeOn=!wakeOn; setWake(wakeOn); });
    document.addEventListener('visibilitychange', ()=>{ if (document.visibilityState==='visible' && wakeOn && !wakeLock){ setWake(true); } });

    // Touch gesture (tap = pause/resume only)
    function isInteractive(target){ return target.closest('.controls, a, .qr, .cta-area'); }

    document.addEventListener('touchend', (e)=>{
      if (isInteractive(e.target)) return;
      setPaused(!paused);
    }, {passive:true});

    // Mouse click support for non-touch devices
    document.addEventListener('click', (e) => {
      if (isInteractive(e.target)) return;
      setPaused(!paused);
    });

    // QR fallback if the remote image fails
    document.getElementById('qr')?.addEventListener('error', ()=>{
      const wrap=document.getElementById('qrWrap');
      if (wrap){ wrap.innerHTML = '<div class="cta-small">Open: '+cfg.ctaUrl+'</div>'; }
    });

    // First-run touch hint
    const hint = document.getElementById('touchHint');
    if (isTouch && hint && !localStorage.getItem('ut_hint_v1')){
      hint.style.display='flex';
      const hide=()=>{ hint.style.display='none'; localStorage.setItem('ut_hint_v1','1'); };
      hint.addEventListener('click', hide);
      setTimeout(hide, 6000);
    }

    render();
    requestAnimationFrame(tick);
  </script>
</body>
</html>
